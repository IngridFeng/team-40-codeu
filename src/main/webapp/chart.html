<!DOCTYPE html>
<html>
<head>
  <title>Chart Pt 1</title>
  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
  <script type="text/javascript">
    google.charts.load('current', {packages: ['corechart','treemap']});
    google.charts.setOnLoadCallback(drawChart);
    google.charts.setOnLoadCallback(drawTree);

    function drawChart(){
      // get book info from servlet
      fetch("/bookchart")
        .then((response) => {
          return response.json();
        })
        .then((bookJson) => {
          // define data table for book info
          var book_data = new google.visualization.DataTable();
          book_data.addColumn('string', 'Book Title');
          book_data.addColumn('number', 'Rating');

          // put all returned info into data table
          for (i=0; i < bookJson.length; i++){
            bookRow = [];
            var title = bookJson[i].title;
            var rating = bookJson[i].rating;
            bookRow.push(title, rating);

            book_data.addRow(bookRow);
          }
          var chart_options = {
            width:800,
            height:400
          };
          var book_chart = new google.visualization.BarChart(document.getElementById('book_chart'));
          book_chart.draw(book_data,chart_options);
        });
      }

    function drawTree(){
      var data = google.visualization.arrayToDataTable([
        ['Location', 'Parent', 'Number of subtopics (children count)', 'Popularity of Subject (student count)'],
        ['School',    null,                 0,                               0],
        ['Computer Science',   'School',             0,                               0],
        ['Arts and Humanities',    'School',             0,                               0],
        ['Social Science',      'School',             0,                               0],
        ['Natural Science', 'School',             0,                               0],
        ['Business',    'School',             0,                               0],
        ['Algorithms and Datastructures',    'Computer Science',            1,                              30],
        ['Math for Computer Science',       'Computer Science',            1,                              50],
        ['Software Construction',    'Computer Science',            1,                              10],
        ['Probabilistics Systems Analysis',    'Computer Science',            1,                              20],
        ['Global History',    'Arts and Humanities',             1,                              60],
        ['Morality and Justice',   'Arts and Humanities',             1,                              40],
        ['Arts and Literature',    'Arts and Humanities',             1,                              10],
        ['Perception and Cognition',     'Social Science',               1,                              40],
        ['Econometrics',     'Social Science',               1,                              20],
        ['Governance and Social Change',     'Social Science',               1,                              10],
        ['Psychology and Analytics',     'Business',             1,                              20],
        ['Financial Budgeting and Evaluation', 'Business',             1,                              20],
        ['Operational Complexity',     'Business',             1,                              10],
      ]);

      tree = new google.visualization.TreeMap(document.getElementById('tree_chart'));

      tree.draw(data, {
        minColor: '#f00',
        midColor: '#ddd',
        maxColor: '#0d0',
        headerHeight: 15,
        fontColor: 'black',
        showScale: true
      });
    }

</script>
</head>
<body>
  <h1>Subjects</h1>
  <div id="book_chart"></div>
  <div id="tree_chart"></div>

</body>
</html>
